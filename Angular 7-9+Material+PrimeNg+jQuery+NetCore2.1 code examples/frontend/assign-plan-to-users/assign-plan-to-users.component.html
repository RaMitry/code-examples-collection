<div fxLayout='column' fxLayoutGap="20px">
    <div fxLayout='row wrap' fxLayoutAlign="space-between center" fxLayoutGap="5px"
    class="user-plan-row">
      <div fxLayout='row wrap' fxLayoutAlign="flex-start center" fxLayoutGap="5px"
      class="user-plan-row-element">
        <div class="select-week-placeholder">
          Select week: 
        </div>
        <div>
            <p-calendar [(ngModel)]="dateRangeValues" selectionMode="range" (onSelect)="selectDate($event)"
            (onFocus)="onDateInputFocus()" [selectOtherMonths]="true" 
            placeholder="Click to select week">
            </p-calendar>
        </div>
      </div>
      <div fxLayout='row wrap' fxLayoutAlign="flex-end center" fxLayoutGap="15px"
      class="user-plan-row-element">
        <div>
          <mat-checkbox>Sorted by Preffered Plan</mat-checkbox>
        </div>
        <div>
          <button mat-raised-button (click)="refreshPlanChanges()" color="accent">Refresh</button>
        </div>
      </div>
    </div>
    <div class="user-plan-row">
      <div class="spinner-container" fxLayout='row' fxLayoutAlign="center center" *ngIf="plansLoadingState$ | async"> 
        <mat-spinner></mat-spinner>
      </div>

      <table mat-table [dataSource]="dataSource">
    
        <ng-container matColumnDef="agents">
          <th mat-header-cell *matHeaderCellDef> Agents </th>
          <td mat-cell *matCellDef="let element"> 
            <button mat-raised-button class="full-name-button" [disableRipple]="true">
              {{element[0].fullName}}
            </button>
          </td>
        </ng-container>
    
        <ng-container matColumnDef="sun">
          <th mat-header-cell *matHeaderCellDef> Sun </th>
          <td mat-cell *matCellDef="let element; let rowIndex = index"> 
            <button mat-raised-button class="user-plan-btn" (click)="setPlan(rowIndex, 1, element[1])"
            [ngStyle]="{'color': planNamesColorsArray[element[1]]}">
              {{planNamesArray[element[1]]}}
            </button>
          </td>
        </ng-container>
    
        <ng-container matColumnDef="mon">
          <th mat-header-cell *matHeaderCellDef> Mon </th>
          <td mat-cell *matCellDef="let element; let rowIndex = index"> 
            <button mat-raised-button class="user-plan-btn" (click)="setPlan(rowIndex, 2, element[2])"
            [ngStyle]="{'color': planNamesColorsArray[element[2]]}">
              {{planNamesArray[element[2]]}}
            </button>
          </td>
        </ng-container>
    
        <ng-container matColumnDef="tue">
          <th mat-header-cell *matHeaderCellDef> Tue </th>
          <td mat-cell *matCellDef="let element; let rowIndex = index"> 
            <button mat-raised-button class="user-plan-btn" (click)="setPlan(rowIndex, 3, element[3])"
            [ngStyle]="{'color': planNamesColorsArray[element[3]]}">
              {{planNamesArray[element[3]]}}
            </button>
          </td>
        </ng-container>
        <ng-container matColumnDef="wed">
          <th mat-header-cell *matHeaderCellDef> Wed </th>
          <td mat-cell *matCellDef="let element; let rowIndex = index"> 
            <button mat-raised-button class="user-plan-btn" (click)="setPlan(rowIndex, 4, element[4])"
            [ngStyle]="{'color': planNamesColorsArray[element[4]]}">
              {{planNamesArray[element[4]]}}
            </button>
          </td>
        </ng-container>
    
        <ng-container matColumnDef="thu">
          <th mat-header-cell *matHeaderCellDef> Thu </th>
          <td mat-cell *matCellDef="let element; let rowIndex = index"> 
            <button mat-raised-button class="user-plan-btn" (click)="setPlan(rowIndex, 5, element[5])"
            [ngStyle]="{'color': planNamesColorsArray[element[5]]}">
              {{planNamesArray[element[5]]}}
            </button>
          </td>
        </ng-container>
    
        <ng-container matColumnDef="fri">
          <th mat-header-cell *matHeaderCellDef> Fri </th>
          <td mat-cell *matCellDef="let element; let rowIndex = index"> 
            <button mat-raised-button class="user-plan-btn" (click)="setPlan(rowIndex, 6, element[6])"
            [ngStyle]="{'color': planNamesColorsArray[element[6]]}">
              {{planNamesArray[element[6]]}}
            </button>
          </td>
        </ng-container>

        <ng-container matColumnDef="sat">
          <th mat-header-cell *matHeaderCellDef> Sat </th>
          <td mat-cell *matCellDef="let element; let rowIndex = index"> 
            <button mat-raised-button class="user-plan-btn" (click)="setPlan(rowIndex, 7, element[7])"
            [ngStyle]="{'color': planNamesColorsArray[element[7]]}">
              {{planNamesArray[element[7]]}}
            </button>
          </td>
        </ng-container>
              
        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>
    
      <mat-paginator #assignPlanToUsersPaginator [pageSize]="5" [pageSizeOptions]="[5, 10, 20]" [showFirstLastButtons]="true">          
      </mat-paginator>
    </div>
    <div fxLayout='row' fxLayoutAlign="flex-end center" fxLayoutGap="20px" class="user-plan-row">
        <div>
          <button mat-raised-button (click)="clearPlanChanges()" color="accent">Clear</button>
        </div>
        <div>
          <button mat-raised-button id="cancel_btn" (click)="cancelBtnClick()">Cancel</button>
        </div>
        <div>
          <button mat-raised-button (click)="savePlanChanges()" color="primary">Save</button>
        </div>
    </div>

</div>
